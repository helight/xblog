+++
title = "nginx模块编程学习笔记2--数据类型"
date = "2012-10-31T09:42:41+08:00"
tags = ["2pc","uwsgi"]
categories = ["linux 应用"]
banner = "img/banners/banner-2.jpg"
draft = false
author = "helight"
authorlink = "https://helight.cn"
summary = ""
keywords = ["2pc","uwsgi"]
+++

在模块种出现了一些nginx特有的数据类型，这里做笔记记录一下。
<div></div>
<div>nginx种数据类型：整型，字符串</div>
<div>src/core/ngx_config.h 种定义了这么集中比较常用的数据类型：</div>
<div>

typedef intptr_t ngx_int_t;<br clear="none" />typedef uintptr_t ngx_uint_t;<br clear="none" />typedef intptr_t ngx_flag_t;

/usr/include/stdint.h:123:typedef unsigned long int uintptr_t;

这里是这么定义这两个类型的，根据了操作系统位数不同而定义。

/* Types for `void *' pointers. */<br clear="none" />#if __WORDSIZE == 64<br clear="none" /># ifndef __intptr_t_defined<br clear="none" /><strong>typedef long int intptr_t;</strong><br clear="none" /># define __intptr_t_defined<br clear="none" /># endif<br clear="none" /><strong>typedef unsigned long int uintptr_t;</strong><br clear="none" />#else<br clear="none" /># ifndef __intptr_t_defined<br clear="none" /><strong>typedef int intptr_t;</strong><br clear="none" /># define __intptr_t_defined<br clear="none" /># endif<br clear="none" /><strong>typedef unsigned int uintptr_t;</strong><br clear="none" />#endif

src/core/ngx_string.h中定义了字符串类型

ngx_str_t

typedef struct {<br clear="none" />size_t len;<br clear="none" />u_char *data; <br clear="none" />} ngx_str_t;

还有对sting类型的基本处理宏

#define ngx_string(str) { sizeof(str) - 1, (u_char *) str }<br clear="none" />#define ngx_null_string { 0, NULL }<br clear="none" />#define ngx_str_set(str, text) \<br clear="none" />(str)-&gt;len = sizeof(text) - 1; (str)-&gt;data = (u_char *) text<br clear="none" />#define ngx_str_null(str) (str)-&gt;len = 0; (str)-&gt;data = NULL

。。。。。

</div>