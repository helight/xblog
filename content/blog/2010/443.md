+++
title = "Fastcgi+apache的安装方式"
date = "2010-08-17T05:19:56+08:00"
tags = ["cgi","apache"]
categories = ["kernel"]
banner = "img/banners/banner-2.jpg"
draft = false
author = "helight"
authorlink = "https://helight.cn"
summary = ""
keywords = ["cgi","apache"]
+++

最近因为一个业务需要，需要安装apache+fastcgi的支持，本来可以直接让运维人员给我配置好的，但是想想，这东西还是自己配的好，方便以后调试啊！这里粗浅的学习了一下，做了一个安装记录，分享一下！

## Apache 的安装

<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">先安装</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">apache<span style="font-family: 宋体;">并且调试没问题</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">这里安装的是<span style="font-family: Times New Roman;">httpd-2.2.9.tar.gz</span><span style="font-family: 宋体;">，在编译安装的时候使用下面的</span><span style="font-family: Times New Roman;">configure</span><span style="font-family: 宋体;">参数：</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">./configure --prefix=/usr/local/apache2 --enable-so --with-mpm=worker </span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">--enable-so <span style="font-family: 宋体;">：是让</span><span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">可以动态加载模块以扩张功能</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">-with-mpm=worker <span style="font-family: 宋体;">：</span></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">支持混合的多线程多进程的多路处理模块</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">（除了<span style="font-family: Times New Roman;">worker</span><span style="font-family: 宋体;">还有一种</span></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">prefork.c</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">，</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">perfork</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">一个非线程型的、预派生的<span style="font-family: Times New Roman;">MPM)</span></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>

<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">
</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">然后编译安装：</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">make &amp;&amp; make install</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">安装完成之后可以测试服务器的运行和对</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">cgi<span style="font-family: 宋体;">的支持情况。</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">确认没有问题后，进行下面的安装操作。</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">2<span style="font-family: 宋体;">、</span><span style="font-family: Times New Roman;">fastcgi</span><span style="font-family: 宋体;">的</span><span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">支持安装</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">从</span><span><a href="http://www.fastcgi.com/"><span style="font-size: 10.5pt; background: #ffffff; color: #336699; font-family: 'Verdana'; mso-spacerun: 'yes'; mso-shading: #ffffff;">http://www.fastcgi.com/</span></a></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">下载<span style="font-family: Times New Roman;">mod_fastcgi-2.4.0.tar.gz</span><span style="font-family: 宋体;">和</span><span style="font-family: Times New Roman;">fcgi-2.4.0.tar.gz</span></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">先给<span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">安装</span><span style="font-family: Times New Roman;">fastcgi</span><span style="font-family: 宋体;">的模块支持。</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"># tar zxf </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">mod_fastcgi-2.4.0.tar.gz</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"># cd </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">mod_fastcgi-2.4.</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">0</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"># cp </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">Makefile.AP2</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"> </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">Makefile</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>

<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">#</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"> make</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">
</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">#</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"> make install</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">安装完成之后修改一下</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">apache<span style="font-family: 宋体;">的配置文件</span><span style="font-family: Times New Roman;">http.conf</span><span style="font-family: 宋体;">，添加下面一些内容：</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">LoadModule fastcgi_module modules/mod_fastcgi.so</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">ScriptAlias /fcgi-bin/ "/data/wwwroot/fcgi-bin/"</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">#fastcgi</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">&lt;Directory "/data/wwwroot/fcgi-bin"&gt;</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">    AllowOverride None</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">    Options +ExecCGI -Includes</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">    AddHandler fastcgi-script .fcg .fcgi</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">    Order allow,deny</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">    Allow from all</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">&lt;/Directory&gt;</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">这里修改了<span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">的主目录的。</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">然后启动<span style="font-family: Times New Roman;">/usr/local/apache2/bin/apachectl restart</span><span style="font-family: 宋体;">，确认模块加载没有问题。</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">3.</span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">安装<span style="font-family: Times New Roman;">fastcgi</span><span style="font-family: 宋体;">开发库</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"># tar zxf </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">fcgi-2.4.0.tar.gz</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"># cd </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';">fcgi-2.4.0</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"># ./configure</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"> # make </span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"> # make install</span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">之后将目录下的<span style="font-family: Times New Roman;">examples</span><span style="font-family: 宋体;">目录中的例子程序拷贝到</span><span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">配置文件指定的</span><span style="font-family: Times New Roman;">fastcgi</span><span style="font-family: 宋体;">运行目录进行测试。</span><span style="font-family: Times New Roman;">Fastcgi</span><span style="font-family: 宋体;">运行目录需要</span><span style="font-family: Times New Roman;">777</span><span style="font-family: 宋体;">的权限或是</span><span style="font-family: Times New Roman;">nobody</span><span style="font-family: 宋体;">的用户读写执行权限。</span></span><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';"></span>
<p class="p0" style="MARGIN-TOP: 0pt; MARGIN-BOTTOM: 0pt"><span style="font-size: 10.5pt; font-family: '宋体'; mso-spacerun: 'yes';">到此，<span style="font-family: Times New Roman;">apache</span><span style="font-family: 宋体;">就完全可以支持</span><span style="font-family: Times New Roman;">cgi</span><span style="font-family: 宋体;">和</span><span style="font-family: Times New Roman;">fastcgi</span><span style="font-family: 宋体;">了。</span></span><span style="font-size: 10.5pt; font-family: 'Times New Roman'; mso-spacerun: 'yes';"></span>

<!--EndFragment-->